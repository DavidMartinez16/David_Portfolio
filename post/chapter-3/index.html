<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Credit Card Fraud Detection | David Martínez</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.74.3" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="https://DavidMartinez16.github.io/David_Portfolio/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css" rel="stylesheet">
    

    

    
      

    

    
    
    <meta property="og:title" content="Credit Card Fraud Detection" />
<meta property="og:description" content="It is important that credit card companies are able to recognize fraudulent credit card transactions so that customers are not charged for items that they did not purchase. This is a machine learning project that uses some anomaly detection algorithms in order to classify fraud and normal transactions.
 Isolation Forest is the model with the best performance, with the highest accuracy. Isolation Forest detected 57 errors versus Local Outlier Factor detecting 97 errors and Support Vector Machines detecting 1420 errors." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://DavidMartinez16.github.io/David_Portfolio/post/chapter-3/" />
<meta property="article:published_time" content="2020-08-31T11:00:59-04:00" />
<meta property="article:modified_time" content="2020-08-31T11:00:59-04:00" />
<meta itemprop="name" content="Credit Card Fraud Detection">
<meta itemprop="description" content="It is important that credit card companies are able to recognize fraudulent credit card transactions so that customers are not charged for items that they did not purchase. This is a machine learning project that uses some anomaly detection algorithms in order to classify fraud and normal transactions.
 Isolation Forest is the model with the best performance, with the highest accuracy. Isolation Forest detected 57 errors versus Local Outlier Factor detecting 97 errors and Support Vector Machines detecting 1420 errors.">
<meta itemprop="datePublished" content="2020-08-31T11:00:59-04:00" />
<meta itemprop="dateModified" content="2020-08-31T11:00:59-04:00" />
<meta itemprop="wordCount" content="407">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Credit Card Fraud Detection"/>
<meta name="twitter:description" content="It is important that credit card companies are able to recognize fraudulent credit card transactions so that customers are not charged for items that they did not purchase. This is a machine learning project that uses some anomaly detection algorithms in order to classify fraud and normal transactions.
 Isolation Forest is the model with the best performance, with the highest accuracy. Isolation Forest detected 57 errors versus Local Outlier Factor detecting 97 errors and Support Vector Machines detecting 1420 errors."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  
  
  <header class="cover bg-top" style="background-image: url('https://DavidMartinez16.github.io/David_Portfolio/images/fre.jpg');">
    <div class="pb3-m pb6-l bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://DavidMartinez16.github.io/David_Portfolio/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        <img src="https://DavidMartinez16.github.io/David_Portfolio/images/casa2.png" class="w100 mw5-ns" alt="David Martínez" />
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
		
	   <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://davidmartinez16.github.io/David_Website/" title="Main Page">
              Main Page
            </a>
          </li>			
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://DavidMartinez16.github.io/David_Portfolio/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://DavidMartinez16.github.io/David_Portfolio/post/" title="Projects page">
              Projects
            </a>
          </li>
          
        </ul>
      
      







<a href="https://www.linkedin.com/in/juan-david-martinez-52b58912b/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>


<a href="https://github.com/DavidMartinez16?tab=repositories" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>








    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Credit Card Fraud Detection</h1>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        PROJECTS
      </aside>
      





      <h1 class="f1 athelas mt3 mb1">Credit Card Fraud Detection</h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="2020-08-31T11:00:59-04:00">August 31, 2020</time>

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>It is important that credit card companies are able to recognize fraudulent credit card transactions so that customers are not charged for items that they did not purchase. This is a machine learning project that uses some anomaly detection algorithms in order to classify fraud and normal transactions.</p>
<ul>
<li>Isolation Forest is the model with the best performance, with the highest accuracy.</li>
<li>Isolation Forest detected 57 errors versus Local Outlier Factor detecting 97 errors and Support Vector Machines detecting 1420 errors.
When comparing error precision &amp; recall for the 3 models , the Isolation Forest performed much better than the LOF and SVM with 42 % against 2% (LOF) and 3% (SVM).</li>
<li>In order to improve the performance of the models you can use:
<ul>
<li>Deep Learning Models to detect more accurately fraud transactions</li>
<li>More complex models of anomaly detection</li>
<li>Use more samples of the fraud class, in this case there was a serious imbalance class problem and that is why the models are not the best.</li>
</ul>
</li>
</ul>
<h2 id="exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</h2>
<p>First, I plotted the numbers of instances per class in order to know how to handle the data. In this case, I found a very serious imbalance class problem, whereas for normal transactions there were 284315 instances and for the fraud transactions there were only 492 instances.</p>
<figure>
    <img src="https://DavidMartinez16.github.io/David_Portfolio/images/classes.jpg"/> 
</figure>

<p>Secondly, I plotted the frequency of transactions throughout time for each class.</p>
<figure>
    <img src="https://DavidMartinez16.github.io/David_Portfolio/images/fre.jpg"/> 
</figure>

<p>And finally, I plotted the scatter of the amount of transactions throughout time for each class.</p>
<figure>
    <img src="https://DavidMartinez16.github.io/David_Portfolio/images/amount.jpg"/> 
</figure>

<h2 id="data-visualization">Data Visualization</h2>
<h3 id="tsne">TSNE</h3>
<p>t-distributed Stochastic Neighbor Embedding (t-SNE). Is a tool to visualize high-dimensional data. It converts similarities between data points to joint probabilities and tries to minimize the Kullback-Leibler divergence between the joint probabilities of the low-dimensional embedding and the high-dimensional data. t-SNE has a cost function that is not convex, i.e. with different initializations we can get different results.</p>
<ul>
<li>Class 0 - Normal Transactions</li>
<li>Class 1 - Fraud Transactions</li>
</ul>
<figure>
    <img src="https://DavidMartinez16.github.io/David_Portfolio/images/tsne.jpg"/> 
</figure>

<h2 id="model-performance">Model Performance</h2>
<p>The following are the classification reports for each model:</p>
<h3 id="isolation-forest">Isolation Forest</h3>
<ul>
<li>Detected Errors: 57</li>
<li>Precision Detecting Fraud Class: 42%</li>
<li>Macro F1 Score: 71%</li>
</ul>
<h3 id="local-outlier-factor">Local Outlier Factor</h3>
<ul>
<li>Detected Errors: 97</li>
<li>Precision Detecting Fraud Class: 2%</li>
<li>Macro F1 Score: 51%</li>
</ul>
<h3 id="support-vector-machine">Support Vector Machine</h3>
<ul>
<li>Detected Errors: 1420</li>
<li>Precision Detecting Fraud Class: 3%</li>
<li>Macro F1 Score: 52%</li>
</ul>
<p>As you can see, the model with the best performance is the Isolation Forest, in order to improve the classification problem you can use more complex anomaly detection models or deep learning models.</p>
<p><a href="https://github.com/DavidMartinez16/Credit-Card-Fraud-Detection">Link to GitHub Repository</a></p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://DavidMartinez16.github.io/David_Portfolio/" >
    &copy;  David Martínez 2020 
  </a>
    <div>







<a href="https://www.linkedin.com/in/juan-david-martinez-52b58912b/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>


<a href="https://github.com/DavidMartinez16?tab=repositories" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>







</div>
  </div>
</footer>

    

  <script src="https://DavidMartinez16.github.io/David_Portfolio/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
